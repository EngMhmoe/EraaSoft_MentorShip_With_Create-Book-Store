//import Component UI
import { useEffect, useState } from "react";
import Img from "../../UI/Img";

//import Components
import SectionLeftFilters from "./SectionLeftFilters";
import SectionRightBooks from "./SectionRightBooks";

//import useTranslation i18next
import { useTranslation } from "react-i18next";
import axios from "axios";
import { UseDomainStore } from "../../../store/Domain";

export default function BooksPage() {
  //domain => (1)
  const domain = UseDomainStore((state) => state.domain);

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  //Data categories => (2)
  const [Categories, setCategories] = useState([]);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //Get categories  Api Strapi => (2)
  async function getCategories() {
    try {
      const responsive = await axios.get(`${domain}/api/categories`);

      // console.log("categories", responsive.data.data);

      setCategories(responsive.data.data);
    } catch (error) {
      console.log("error categories", error);
    }
  }

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //useEffect With Get categories  => (2)
  useEffect(() => {
    getCategories();
  }, []);

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  //Data Years => (3)
  const [Years, setYears] = useState([]);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //Get Years Api Strapi => (3)
  async function getYears() {
    try {
      const responsive = await axios.get(`${domain}/api/category-years`);

      // console.log("Years", responsive.data.data);

      setYears(responsive.data.data);
    } catch (error) {
      console.log("error Years", error);
    }
  }

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //useEffect With Get Years  => (3)
  useEffect(() => {
    getYears();
  }, []);

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  //Data Products => (4)
  const [ALLBook, setALLBooks] = useState([]);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //pagination => (4)
  const [Page, setPage] = useState(1);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //filters Categories => (4)
  const [selectCategory, setSelectCategory] = useState([]);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //filters Years => (4)
  const [selectYears, setSelectYears] = useState([]);

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //Get Products  Api Strapi => (4)
  async function getAllBooks() {
    try {
      const responsive = await axios.get(`${domain}/api/products`, {
        params: {
          populate: "*",

          pagination: {
            // page: 3,
            page: Page,
            // pageSize: `${pageSize}`,
            pageSize: 4,
          },

          filters: {
            $or: [
              {
                category: {
                  category_name: selectCategory,
                },
              },

              {
                publicationYear: selectYears,
              },
            ],
          },
        },
      });

      // console.log("Products", responsive.data);

      setALLBooks(responsive.data.data);
    } catch (error) {
      console.log("error AllBooks", error);
    }
  }

  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\
  //\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\

  //useEffect With Get Products => (4)
  useEffect(() => {
    getAllBooks();
  }, [Page, selectCategory, selectYears]);

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  //value ar => (5)
  const { t } = useTranslation();

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  const Publishers = [
    { name: "Paulo coelo", Count: "210" },
    { name: "Jane Austen", Count: "140" },
    { name: "Charles Dickens", Count: "309" },
    { name: "Mark Twain", Count: "102" },
    { name: "Virginia Woolf", Count: "204" },
    { name: "Leo Tolstoy", Count: "89" },
    { name: "Fyodor Dostoevsky", Count: "47" },
    { name: "Haruki Murakami", Count: "211" },
    { name: "Gabriel MÃ¡rquez", Count: "92" },
    { name: "Chinua Achebe", Count: "92" },
  ];

  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////////////////////////////

  return (
    <section>
      {/* Component Img */}
      <Img size={38} />

      {/* /////////////////////////////////////////////////////////////////// */}
      {/* /////////////////////////////////////////////////////////////////// */}
      {/* /////////////////////////////////////////////////////////////////// */}
      {/* /////////////////////////////////////////////////////////////////// */}
      {/* /////////////////////////////////////////////////////////////////// */}

      <div className="flex pt-50 gap-6 mx-5 font-bold">
        {/* Section Left Component Filters */}
        <section className=" hidden sm:flex  row-span-1">
          <SectionLeftFilters
            Categories={Categories}
            Years={Years}
            setSelectCategory={setSelectCategory}
            setSelectYears={setSelectYears}
            //\/\/\/\/\/\/\/\/\/\/\/\/\\/\/\/\/\
            Publishers={Publishers}
            t={t}
          />
        </section>

        {/* //////////////////////////////////////////////////////////////////////////////////////////////////////////////// */}
        {/* //////////////////////////////////////////////////////////////////////////////////////////////////////////////// */}
        {/* //////////////////////////////////////////////////////////////////////////////////////////////////////////////// */}
        {/* //////////////////////////////////////////////////////////////////////////////////////////////////////////////// */}
        {/* //////////////////////////////////////////////////////////////////////////////////////////////////////////////// */}

        {/* Section Right Component Filters */}
        <section className=" xl:w-246 w-25 mb-10 grow">
          <SectionRightBooks
            ALLBook={ALLBook}
            Categories={Categories}
            Years={Years}
            setPage={setPage}
            setSelectCategory={setSelectCategory}
            setSelectYears={setSelectYears}
            ///\/\/\/\/\/\/\/\/\/\/\/\/\/\
            Publishers={Publishers}
            t={t}
          />
        </section>
      </div>
    </section>
  );
}
